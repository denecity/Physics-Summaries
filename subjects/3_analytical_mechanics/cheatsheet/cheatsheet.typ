#import "../../../lib/lib.typ": *
#import "../../../lib/setup_cheatsheet.typ": cheatsheet-setup
#show: frame-style(styles.boxy)

#show: cheatsheet-setup(
  title: "Analytical Mechanics Cheatsheet",
  author: "Denis Titov",
  language: "ENG",
)

= Theory

== Lagrangian

$
  L(q, dot(q), t) = T(q, dot(q), t) - V(q, t)\
  T(dot(q)_1, ..., dot(q)_n) = 1/2 sum_i m_i dot(q_i)^2 "generally"\
  V = V(q_1, ..., q_n, t) "potential energy"\
  dv(,t) (pdv(L, dot(q)_i)) = pdv(L, q_i)\
$

== Infinitessimal Transformation and conserved Quantities

+ Choose Transformation. Start with translations, then rotations, then scaling, then more complex transformations.\

+ Test for Incariance with first order change of Lagrangian $delta L$

+ Identify the Symmetry. If $delta L = dv(F, t)$ or $0$ you have a symmetry.

+ Calculate the Conserver Quantity. Once symmetry is confirmed, use Noethers Theorem to find the conserved quantity $Q$.

$
  x_i -> x_i + epsilon, abs(epsilon) << 1\
  f(x + epsilon) = f(x) + epsilon f'(x) + 
  epsilon^2 (f''(x))/2! + O(epsilon^3)\
  "if" q_i -> q_i + epsilon_i, dot(q)_i -> dot(q)_i + mu_i\
  => Delta L = L(q_i + epsilon_i, dot(q)_i + mu_i) - L(q_i, dot(q)_i, t)\
  delta L = sum_i (pdv(L, q_i) epsilon_i + pdv(L, dot(q)_i) mu_i) + O(epsilon^2, mu^2)\
  "if symmetry: " delta L = 0\
  "find for which constant this is the case"\
  "If" delta L = dv(F, t) "calculate" F, "else" F = 0\
  Q = (sum_i pdv(L, dot(q)_i)) - F\ 
$

== Legendre Transform: Lagrangian to Hamiltonian

$
  L = L(q_1, ..., q_n, dot(q_1), ..., dot(q)_n, t)\
  p_i = pdv(L, dot(q)_i)\
  q_i = q_i (q_j, p_j, t)\
  H(q, p, t) = sum_i p_i q_i - L(q, dot(q), t)\
  H = H(q_1, ..., q_n, p_1, ..., p_n, t)\

$

== Hamiltonian

$
  dot(q)_i = pdv(H, p_i), dot(p)_i = -pdv(H, q_i)
$

== Poisson Bracket: Is Quantity Conserved?

The Change of Function $G$ along the Flow of generated by $F$ is given by Poisson Bracket ${G, F}$

$
  {A, B} = sum_i (pdv(A, q_i) pdv(B, p_i) - pdv(A, p_i) pdv(B, q_i))\
  "if" {H, A} = 0 "then" A "is conserved"\
$

== Differentiating unknown Potential

$
  V = V(sqrt(x^2 + y^2)), r = sqrt(x^2 + y^2)\
  pdv(V, x) = dv(V, r) pdv(r, x) = dv(V, r) x/r\
  pdv(V, x) = V'(sqrt(x^2 + y^2)) x/sqrt(x^2 + y^2)\
$

If central potential, e.g. $V(abs(x_1 - x_2))$:

$
  r = x_1 - x_2 hspace grad V (r) = pdv(V, r) grad r hspace grad r = pdv(r, x_2) hat(x_1) + pdv(r,x_2) hat(x_2) = hat(x_1) - hat(x_2) = hat(r)\
  => grad V (r) = pdv(V, r) hat(r) hspace F = - grad V(r) = - dv(V, r) hat(r)\
$

== Flow and Hamiltonian Invariance

Invariance unter Hamiltonian means that Hamiltonian doesnt change from when you plug in initial values. $lambda$ is to $F$ how $t$ is to $H$.

$
  dv(phi_F^lambda, lambda) = {phi^lambda_F, F}\
  dv(G, lambda) = {G, F}\
  dv(q_i, lambda) = {q_i, F} = pdv(F, p_i)\
  dv(p_i, lambda) = {p_i, F} = -pdv(F, q_i)\
$

Invariance:

$
  "calculate diff. equation for" x(lambda), y(lambda), p_x (lambda), p_y (lambda)\
  "check if" H(x(lambda), y(lambda), p_x (lambda), p_y (lambda)) = H(x, y, p_x, p_y)\
  "with" x iso x_0
$

== Canoncial Transformation and Generating Function

Transformation $Q = Q(q, p), P=P(q, p)$ is canonical if:

$
  {Q_j, Q_k}_(q p) = 0 hspace {P_j, P_k}_(q p) = 0 hspace {Q_j, P_k}_(q p) = delta_(j k)\
$

A Generating Function is a function that connects the old coordinates to the new ones:

$
  F = F_1 (q, Q, t) hspace p_i = pdv(F_1, q_i) hspace P_i = - pdv(F_1, Q_i)\
$

Integrate these to find the explicit form of $F_1$. Sol. for ex: $F_1(q, Q) = q P$

== Noethers Theorem

If an infinitessimal change in a coordinate only changes the Lagrangian by a total time derivative, then the corresponding conserved quantity is given by the change in the Lagrangian.

$
  delta L = dv(F, t) = dv(, t) [sum_alpha nu^alpha pdv(L, dot(q)_alpha)] = [sum_alpha nu^alpha p_alpha] "where" nu^alpha "generator"\
  => Q = (sum_i p_i epsilon) - F\
  "if" pdv(L, q_k) = 0 => dv(, t) pdv(L, dot(q)_k) = 0 => F = p_k = pdv(L, dot(q)_k)\

$

== Noethers Derivation

Given a Transformation $(x, y) -> (phi_x^lambda, phi_y^lambda) = (x', y')$ that leaves the Lagrangian invariant

$
  L(q'(lambda), dot(q)'(lambda)) = L(q, dot(q))\
$

the total time derivative of the Lagrangian with respect to $lambda$ must be zero, evaluated at $lambda = 0$. We do the following transformations:

$
  dv(L, lambda)|_(lambda = 0) = 0 = sum_i (pdv(L, q_i) pdv(q'_i, lambda) + pdv(L, dot(q)_i) pdv(dot(q)'_i, lambda))|_(lambda = 0)
$

This defines the generator

$
  nu^i = pdv(q'_i, lambda)|_(lambda = 0)
$

Derivation:

$
  pdv(dot(q)'_i, lambda) = pdv(, lambda) dv(q'_i, t) = dv(, t) pdv(q'_i, lambda) hspace sum_i (pdv(L, q_i) nu^i + pdv(L, dot(q)_i) dot(nu)^i ) = 0 hspace pdv(L, q_i) = dv(, t) pdv(L, dot(q)_i)\
  => sum_i ([dv(,t) (pdv(L, dot(q)_i)) nu^i + pdv(L, dot(q)_i) dot(nu)^i)] hspace dv(,t) (pdv(L, dot(q)_i) nu^i) = [dv(, t) pdv(L, dot(q)_i)] nu^i + pdv(L, dot(q)_i) dot(nu)^i\
  => sum_i dv(, t) (pdv(L, dot(q)_i) nu^i) = dv(, t)sum_i  (pdv(L, dot(q)_i) nu^i) = dv(, t) Q = 0 => Q hspace p_i = pdv(L, dot(q)_i)\
  => Q = sum_i p_i nu^i\
$

== Central Potential Problems

We reduce the problem to one body:

$
  R = (m_1 x_1 + m_2 x_2)/(m_1 + m_2) hspace r = x_1 + x_2 hspace M = m_1 + m_2 hspace mu = (m_1 m_2)/(m_1 + m_2)\
$

Substitutin this usualle gives

$
  ddot(R) = 0 hspace mu ddot(r) = - pdv(, r) V(r)\
  dv(, t) L = dv(,t) (r times p) = (dot(r) times p + r times dot(p)) = 0\
  dv(, t) E = dv(, t) 1/2 mu v^2 + V(r) = 0\
$

When Angular Momentum is conserved, the problem can be reduced to a plane, perpendicular to $L$. Then we can express the problem in polar coordinates $(r, phi)$.

$
  L = mu r^2 phi = "const"
$

Then we use conservation of energy:

$
  T = 1/2 mu v^2 = 1/2 mu (dot(r)^2 + r^2 dot(phi)^2) hspace dot(phi) = L/(mu r^2)\
  E = 1/2 mu dot(r)^2 + 1/2 mu r^2 (L/(mu r^2))^2 + V(r) = 1/2 mu dot(r)^2 + L^2/(2 mu r^2) + V(r)\
  V_"eff" (r) = V(r) + L^2/(2 mu r^2) => E = 1/2 mu dot(r)^2 + V_"eff" (r)\
  => dot(r) = dv(r, t) = sqrt(2/mu (E - V_"eff" (r))) => dv(r, phi) dv(phi, t) = dv(r, phi) (L/(mu r^2))\
  => dd(phi) = (L/(mu r^2))/sqrt(2/mu (E- V_"eff" (r))) dd(r) => integral => phi(r) => r(phi)\
$

== Propagator ODE

For a linear, homogeneous system:

$
  dot(z) (t) = A(t) z(t)\ => "Defining Equation" pdv(P(t,s),t ) = A(t) P(t,s), P(s,s) = id\
  => z(t) = P(t,s) z(s)\
  "if" A "not time dependent:" P(t, s) = exp(A (t - s))\
  "side term" dot(z) = A z + b => z(t) = P(t,s) z(s) + integral_s^t P(t,u) b(u) dd(u)\
  "Bsp. time indep.:" dot.double(x) = -x + a(t), z(t) = mat(x(t); dot(x) (t))\
  => mat(x; dot(x)) = mat(0, 1; -1, 0) mat(x; dot(x)) + mat(0; a) => P = exp (mat(0, 1; -1, 0) (t-s))\
  => P = mat(cos(t-s), sin(t-s); -sin(t-s), cos(t-s))\
   => x(t) = x_0 cos(t-s) + dot(x)_0 sin(t-s) + integral_s^t sin(t-u) a(u) dd(u)\
$

== Matrix Exponential

$
  exp(A theta) = id + A theta + 1/2! A^2 theta^2 + 1/3! A^3 theta^3 + ...\
$

== Lagrange Multiplier

Suppose we want to find the curve $y(x)$ that extremizes the functional.

$
  S[y] = integral_(x_0)^(x_1) f(y, y', x) dd(x)\
$

with the constaint of another functional

$
  C[y] = integral_(x_0)^(x_1) g(y, y', x) dd(x) = "const"\
$

We define

$
  H[y] = S[y] + lambda C[y] = integral_(x_0)^(x_1) (f - lambda g) dd(x) hspace h = f - lambda g\
  "Euler Lagrange:" pdv(h, y) - dv(,t) pdv(h, y') = 0\
$

== Rotational Kinematics

The net extermal torque $M_"inertial"$ equals the rate of change of angular momentum $dv(L, t)$.

$
  &"Angular Position" &&theta\
  &"Angular Velocity" &&omega = dv(theta, t)\
  &"Angular Acceleration" &&dot(omega) = dv(, t) omega\
  & "Linear Velocity" && v = omega times r\
  & "Linear Acceleration" && a = dot(omega) times r + omega times v\
  &&&= dot(omega) times r + omega times (omega times r)\
  &&&= a_t + a_r\
  & "Tangential Acceleration" && a_t = dot(omega) times r\
  & "Radial Acceleration" && a_r = omega^2 times r\
  & "Torque" && M = r times F = dv(L, t)\
  & "Moment of Inertia" && I = sum_i m_i r_i^2\
  &&&= integral_m r^2 dd(m)\
  & "Second Law for Rotation" && sum M_"ext" = I dot(omega)\
  & "Rotational Kinetic Energy" && T = 1/2 I omega^2\
  & "Angular Momentum" && L = dv(L, t) = I omega = m (x times dot(x))\
  & "Angular Velocity Tensor" && Omega = mat(0, -omega_z, omega_y; omega_z, 0, -omega_x; -omega_y, omega_x, 0)\
  &&& Omega ax = omega times ax\
$

Let $x$ be inertial and $y$ body-fixed. Then:

$
  x = R y hspace y = R^T x hspace omega_"in" = R omega_"body" hspace omega_"body" = R^T omega_"in"\
  L = R S hspace S = R^T L hspace M_"in" = R M_"body" hspace M_"body" = R^T M_"in"\
  Theta_"in" = R Theta_"body" R^T hspace Theta_"body" = R^T Theta_"in" R\
  Omega_"in" = R Omega_"body" R^T hspace
  Omega_"body" = R^T Omega_"in" R\
$

== Tensor of Inertia

Consider a dumbbell rotating at $45$ degrees. The masses want to move outward. This requires a constantly changing torque. This means $M = dv(L, t)$ cannot be parallel with $omega$.

$

  Theta = sum_i m_i mat(
  y_i^2 + z_i^2, -x_i y_i, -x_i z_i;
  -y_i x_i, x_i^2 + z_i^2, -y_i z_i;
  -z_i x_i, -z_i y_i, x_i^2 + y_i^2)\
  => Theta_(j k) = sum_i m_i (delta_(j k) |vec(x)_i|^2 - x_(i,j) x_(i,k))
$

$
  Theta = integral mat(
  y_i^2 + z_i^2, -x_i y_i, -x_i z_i;
  -y_i x_i, x_i^2 + z_i^2, -y_i z_i;
  -z_i x_i, -z_i y_i, x_i^2 + y_i^2) dd(m)\
  => Theta_(j k) = integral (delta_(j k) |vec(x)|^2 - x_j x_k) d m\
  L = Theta omega hspace T = 1/2 omega^T Theta omega\
  "Principal axes when" Theta = diag(I_1, I_2, I_3)
$

If rotational axis is not aligned with center of mass, we can use:

$
  I_(i j) = I_(C M, i j) + M (d^2 delta_(i j) - d_i d_j)\
  "when axis parallel:" I = I_"CM" + M d^2\
$

*THE GENERAL SOLUTION:*

$
  Theta dot(omega) = - omega times (Theta omega) + M_y
$

Derivation:

$
  L_"in" = R(t) L_B (t) hspace M_"in" = dv(L_"in", t) = dv(, t) R L_B = dot(R) L_B + R dot(L)_B\
  Omega_B = R^T dot(R) => dot(R) = R Omega_B hspace M_"in" = R Omega_B L_B + R dot(L)_B = R M_B => M_B = Omega_B L_B + dot(L)_B\
  Omega L = omega times L => M_B = omega_B times L_B + dot(L)_B\
  L_B = Theta_B omega_B => dot(L)_B = Theta_B dot(omega_B) hspace M_B = omega_B times (Theta_B omega_B) + Theta_B dot(omega_B)\
  => Theta_B dot(omega_B) = - omega_B times (Theta_B omega_B) + M_B\
  
$

= Good to know

$
  &"Height" && #h(60pt) V= m g h\
  &"Spring" && V= 1/2 k x^2\
  &"Electrostatic" && V= k (q_1 q_2) / r\
  &"Kinetic Energy" && T= 1/2 m v^2\
  &"Angular Momentum" #h(15pt) && L= m r^2 dot(phi)\
$

== Calculus

$
  &"Chain Rule" &&& dv(, x) (f(g(x))) = dv(f, g(x)) dv(g, x)\
  &&&& f(g(x)) = f'(g(x)) g'(x)\
  &&&&f(x) = A cos(B x^3), dv(f, x) = -3 A B x^2 sin(B x^3)\
  &"Product Rule" &&& dv(,x)(f(x) g(x)) = f(x) dv(g, x) + g(x) dv(f, x)\
  &&&&f(x) = A x^2, g(x) = B sin(x), dv(f g, x) = A B x^2 cos(x) + 2 A x B sin(x)\
  &"Quotient Rule" &&& dv(,x)(f(x)/g(x)) = (g(x) dv(f, x) - f(x) dv(g, x))/(g(x))^2\
  &"Integration by Parts" &&& integral u dd(v) = u v - integral v dd(u)\
  &&&& integral_(x_1)^x_2 u dd(v) = [u v]_(x_1)^(x_2) - integral_(x_1)^(x_2) v dd(u)\
  &"Integral Differential" &&& dv(,t) integral_a(t)^b(t) f(x, t) dd(x) = integral_a(t)^b(t) pdv(f, t) dd(x) + f(b(t), t) dv(b, t) - f(a(t), a) dv(a, t) \
$

== series

$
  1 / (1 - x) &= sum_(n=0)^infinity x^n &&ยง= 1 + x + x^2 + x^3 + ... text("for") space |x| < 1\

  // Exponential Function
  e^x &= sum_(n=0)^infinity x^n / (n!) &&= 1 + x + x^2 / (2!) + x^3 / (3!) + ... text("for all") space x\

  // Cosine (from Euler's formula)
  cos(x) &= sum_(n=0)^infinity (-1)^n / ((2n)!) x^(2n) &&= 1 - x^2 / (2!) + x^4 / (4!) - ... text("for all") space x\

  // Sine (from Euler's formula)
  sin(x) &= sum_(n=0)^infinity (-1)^n / ((2n+1)!) x^(2n+1) &&= x - x^3 / (3!) + x^5 / (5!) - ... text("for all") space x\

  // Natural Logarithm
  ln(1 + x) &= sum_(n=1)^infinity (-1)^(n+1) / n x^n &&= x - x^2/2 + x^3/3 - ... text("for") space |x| < 1\

  (1 + x)^alpha &= sum_(n=0)^infinity binom(alpha, n) x^n &&= 1 + alpha x + (alpha(alpha-1))/(2!)x^2 + ... text("for") space |x| < 1\
$

== Trig Identities

$
  cos(A) - cos(B) &= -2 sin((A + B)/2) sin((A - B)/2)\
  cos(A) + cos(B) &= 2 cos((A + B)/2) cos((A - B)/2)\
  cos^2 (A) - sin^2 (A) &= 2 cos^2 (A) - 1 = 1 - 2 sin^2 (A)\
$


= Derivations

== Noethers Theorem and Euler-Lagrange Equation

$
  cal(F) [y] = integral_(x_0)^(x_1) (f(y, y', x) dd(x) hspace Y = y(x) + epsilon eta (x) hspace Y' = y'(x) + epsilon eta'(x)\
  "extremal if" pdv(cal(F), epsilon)|_(epsilon=0) = 0 forall eta(x) hspace eta(x_0) = 0 = eta(x_1)\
  pdv(f, epsilon) (Y, Y', x) = pdv(f, Y) pdv(Y, epsilon) + pdv(f, Y') pdv(Y', epsilon) hspace pdv(Y, epsilon) = eta(x) mid(hspace)  pdv(Y', epsilon) = eta'(x)\
  => pdv(cal(F), epsilon) = integral_(x_0)^(x_1) (pdv(f, Y) eta + pdv(f, Y') eta') dd(x)\ 
  "int by parts:" integral_(x_0)^(x_1) pdv(f, Y') eta' dd(x) = [pdv(f, Y') eta]_(x_0)^(x_1) - integral_(x_0)^(x_1) dv(, x) pdv(f, Y') eta dd(x)\
  pdv(cal(F), epsilon) = eta integral_(x_0)^(x_1) (pdv(f, Y) - dv(, x) pdv(f, Y')) dd(x) | Y = y + epsilon eta|_(epsilon = 0) => Y = y\
  pdv(cal(F), epsilon) |_(epsilon=0) = eta integral_(x_0)^(x_1) (pdv(f, y) - dv(, x) pdv(f, y')) dd(x) forall eta => pdv(f, y) - dv(, x) pdv(f, y') = 0\
$

Now with Total Differential:

$
  L' = L + dv(G, t) hspace S' = integral_(t_0)^(t_1) (L + dv(G, t)) dd(t) = S + [G]_(t_0)^(t_1) => pdv(S', epsilon) = pdv(S, epsilon)
$

Example Freie Teilchen:

$
  L = 1/2 m dot(x)^2 hspace x' = x + epsilon t hspace L' = 1/2 m dot(x)^2 + m dot(x) epsilon + 1/2 m epsilon^2\
  => delta L = m dot(x) epsilon + O(epsilon^2) hspace dv(, t) (m x epsilon) => F = m x epsilon hspace Q = (pdv(L, dot(x)) delta x) - F\
  Q = (m dot(x)) (epsilon t) - (m epsilon x) => Q_"cons" = m(dot(x) t - x) "Schwerpunkt"
$



== Noethers Theorem and Conserved Quantities

Types of Symmetries:

+ *Cyclic Coordinates* (coordinates that are not in the Lagrangian) indicates translation symmetry: $pdv(L, q_k) = 0 => p_k = pdv(L, dot(q)_k) = "const"$
+ *Rotational Symmetries* (coordinates that always appear together e.g. $x^2 + y^2$ or $V(sqrt(x^2 + y^2 + z^2))$) means the Lagrangian is dependent on e.b. $r = sqrt(x^2 + y^2)$ instead of $x, y$. This indicates rotational symmetry. Then $x = r cos theta, y = r sin theta => pdv(L, theta) = 0 => p_theta = L_z = "const"$.
+ *Relative Distances* (e.g. $V(x - y)$) indicates global translation symmetry: $R = (m_1 r_1 + m_2 r_2)/(m_1 + m_2), pdv(L, R) = 0 =>$ total relative momentum $p_R = "const"$.

To check if quantity $F$ is conserved, check if $F$ is a function of cyclic coordinates or ${F, H} = 0$.

= Relativity

== Rocket Equation Derivation

Energy-Momentum Tensor is conserved. We look at infinitessimal ejection on Fuel with velocity. We build differential equation. We Lorentz-Transform back to observer frame.

$v$ is ejection speed of fuel.

$
  P^mu = mat(E/c; p_x, p_y, p_z) = mat(gamma(v) m_0 c; gamma(v) m_0 v_x, gamma(v) m_0 v_y, gamma(v) m_0 v_z)\
  Lambda^mu_nu = mat(gamma, beta gamma; beta gamma, gamma)\
  P^mu = Lambda^mu_nu P'^nu\
$

We look at event of ejection of infinitessimal amount of fuel. We have $P^(mu')_"init" = P^(mu')_"final"$.

$
  P^(mu')_"init" = mat(m c; 0; 0; 0)
$

During the event the rocket mass changes $m + dd(m)$ where $dd(m)$ is negative. Fuel particle is ejected with $u$ in $-x'$ and rocket accelerates in $+x'$ direction.

$
  P^(mu')_"rocket" = mat(gamma(dd(v')) (m + dd(m)) c; gamma(dd(v')) (m + dd(m)) dd(v'); 0; 0)\
  P^(mu')_"fuel" = mat(gamma(u) dd(m_e) c; gamma(u) dd(m_e) (-u); 0; 0)\
  P^(mu')_"final" = P^(mu')_"rocket" + P^(mu')_"fuel"\
  => m c = (m + dd(m)) c + gamma(u) dd(m_e) c\
  => -dd(m) = gamma(u) dd(m_e)\
$

This means the decrease of the rocket mass is larger than the mass of the fuel ejected.

Momentum conservation:

$
  0 = (m + dd(m)) dd(v') - gamma(u) u dd(m_e)\
  = (m + dd(m)) dd(v') - gamma(u) u -dd(m)/gamma(u) = (m + dd(m)) dd(v') + u dd(m)\
  =>m dd(v') = - u dd(m)\
$

We transform back to observer frame:

$
  v + dd(v) = (v + dd(v'))/(1 + (v dd(v')/c^2))\
  "linearize:" v + dd(v) approx (v + dd(v')) (1 - (v dd(v')/c^2)) approx v - (v^2 dd(v')/c^2) + dd(v') - (v dd(v')^2/c^2)\
  => dd(v) = dd(v') - (v^2 dd(v'))/c^2 = dd(v') (1 - v^2/c^2) = dd(v) = dd(v') / gamma^2(v) => dd(v') = gamma^2(v) dd(v)\
$

Thei final step is integration through mass:

$
  gamma^2(v) dd(v) = - u dd(m)/m = v^2/c^2)\
  integral_(0)^v 1/(1 - v'^2/c^2) dd(v') = - integral_(m_0)^m u dd(m')/m'\
  x = v'/c => integral_(0)^v 1/(1 - v'^2/c^2) dd(v') = c integral_0^(v/c) 1/(1 - x^2) dd(x) = c "artanh"(v/c)\
  = integral_(m_0)^m u dd(m')/m' = -u(ln(m) - ln(m_0))\
  => v = c tanh(u/c ln(m_0/m))\
  qed
$